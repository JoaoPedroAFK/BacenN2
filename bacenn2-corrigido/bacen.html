<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gest√£o BACEN - Sistema Velotax</title>
    
    <!-- Fontes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Estilos -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/theme-dark.css">
    
    <!-- Script Inline: Definir buscarClientePorCPF ANTES do body ser renderizado -->
    <script>
        // Definir buscarClientePorCPF ANTES do body ser renderizado
        // Isso evita erro quando o HTML tenta chamar a fun√ß√£o no onclick
        window.buscarClientePorCPF = async function() {
            // Verificar se historicoCliente j√° est√° dispon√≠vel
            if (window.historicoCliente && typeof window.historicoCliente.mostrarHistorico === 'function') {
                const input = document.getElementById('busca-cliente-cpf');
                const cpf = input ? input.value.trim() : '';
                if (cpf) {
                    const cpfLimpo = cpf.replace(/\D/g, '');
                    if (cpfLimpo.length < 11) {
                        if (typeof mostrarAlerta === 'function') {
                            mostrarAlerta('CPF inv√°lido. Digite os 11 d√≠gitos.', 'warning');
                        } else {
                            alert('CPF inv√°lido. Digite os 11 d√≠gitos.');
                        }
                        return;
                    }
                    await window.historicoCliente.mostrarHistorico(cpf);
                    if (input) input.value = '';
                } else {
                    if (typeof mostrarAlerta === 'function') {
                        mostrarAlerta('Digite um CPF para buscar', 'info');
                    } else {
                        alert('Digite um CPF para buscar');
                    }
                }
            } else {
                console.warn('‚ö†Ô∏è historicoCliente ainda n√£o est√° dispon√≠vel, aguardando...');
                // Aguardar um pouco e tentar novamente
                setTimeout(() => {
                    if (window.historicoCliente) {
                        window.buscarClientePorCPF();
                    } else {
                        alert('Sistema ainda carregando. Tente novamente em alguns segundos.');
                    }
                }, 500);
            }
        };
        console.log('‚úÖ buscarClientePorCPF definido globalmente no <head> (bacen.html)');
    </script>
    
    <!-- Script Inline: Definir mostrarSecao ANTES dos bot√µes serem renderizados -->
    <script>
        // Fun√ß√£o mostrarSecao deve estar dispon√≠vel GLOBALMENTE antes dos bot√µes
        // Esta fun√ß√£o ser√° sobrescrita/refor√ßada pelo bacen-page.js quando carregar
        window.mostrarSecao = function(secaoId) {
            console.log('üîò mostrarSecao chamado com:', secaoId);
            
            // Esconder todas as se√ß√µes
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remover active de todos os bot√µes
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Mostrar se√ß√£o selecionada
            const section = document.getElementById(secaoId);
            if (section) {
                section.classList.add('active');
            } else {
                console.warn('‚ö†Ô∏è Se√ß√£o n√£o encontrada:', secaoId);
            }
            
            // Ativar bot√£o correspondente
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if (btn.getAttribute('onclick') && btn.getAttribute('onclick').includes(`'${secaoId}'`)) {
                    btn.classList.add('active');
                }
            });
        };
        console.log('‚úÖ mostrarSecao definido globalmente no <head> (bacen.html)');
        
        // Fun√ß√£o para auto-marcar "Enviar para cobran√ßa" quando PIX liberado e contrato em aberto
        function verificarAutoCobrancaBacen() {
            const pixStatus = document.getElementById('bacen-pix-status')?.value;
            const contratoAberto = document.getElementById('bacen-status-contrato-aberto')?.checked;
            
            if (pixStatus === 'Liberado' && contratoAberto) {
                const radioSim = document.querySelector('input[name="bacen-enviar-cobranca"][value="Sim"]');
                if (radioSim) {
                    radioSim.checked = true;
                    console.log('‚úÖ Auto-marcado "Enviar para cobran√ßa" como Sim (PIX Liberado + Contrato em Aberto)');
                }
            }
        }
    </script>
    
    <style>
        /* Estilos espec√≠ficos BACEN */
        .bacen-header {
            background: linear-gradient(135deg, #000058 0%, #1634FF 100%);
            color: white !important;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
        }
        
        .bacen-header h2,
        .bacen-header h3,
        .bacen-header p {
            color: white !important;
        }
        
        .bacen-card {
            border-left: 4px solid #1634FF;
        }
        
        .bacen-badge {
            background: #1634FF;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="velohub-header">
        <div class="header-content">
                <div class="header-logo">
                    <div class="logo-container">
                        <img src="img/simbolo_velotax_ajustada_branco.png" alt="Velotax" class="logo-header">
                    </div>
                    <h1>BACEN</h1>
                </div>
            <div class="header-actions">
                <span id="alertas-badge" class="alertas-badge" style="display: none;">0</span>
                <a href="index.html" class="velohub-btn btn-secondary" style="text-decoration: none; color: white; margin-right: 12px;">üè† Voltar √† Home</a>
                <button class="theme-toggle-btn" onclick="toggleTheme()">üåô</button>
            </div>
        </div>
    </header>

    <!-- Menu CANAIS -->
    <nav class="nav nav-canais">
        <div class="canais-menu">
            <span class="canais-label">CANAIS:</span>
            <a href="bacen.html" class="nav-btn canais-btn active">BACEN</a>
            <a href="n2.html" class="nav-btn canais-btn">N2</a>
            <a href="chatbot.html" class="nav-btn canais-btn">Chatbot</a>
        </div>
        <div class="busca-cliente-inline">
            <input type="text" id="busca-cliente-cpf" class="velohub-input busca-cliente-input" placeholder="üîç Buscar cliente por CPF..." onkeypress="if(event.key === 'Enter') buscarClientePorCPF()">
            <button class="velohub-btn btn-secondary btn-buscar-cliente" onclick="buscarClientePorCPF()">Buscar</button>
        </div>
    </nav>

    <!-- Navega√ß√£o -->
    <nav class="nav">
        <button class="nav-btn active" onclick="mostrarSecao('dashboard-bacen')">üìä Dashboard</button>
        <button class="nav-btn" onclick="mostrarSecao('minhas-reclamacoes-bacen')">üë§ Minhas Reclama√ß√µes</button>
        <button class="nav-btn" onclick="mostrarSecao('nova-reclamacao-bacen')">‚ûï Nova Reclama√ß√£o BACEN</button>
        <button class="nav-btn" onclick="mostrarSecao('lista-bacen')">üìã Lista de Reclama√ß√µes</button>
        <button class="nav-btn" onclick="mostrarSecao('relatorios-bacen')">üìà Relat√≥rios</button>
    </nav>

    <!-- Container Principal -->
    <main class="velohub-container">
        <!-- Dashboard BACEN -->
        <section id="dashboard-bacen" class="section active">
            <div class="bacen-header">
                <h2>üìä Dashboard BACEN</h2>
                <p>M√©tricas e estat√≠sticas das reclama√ß√µes do Banco Central</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card bacen-card">
                    <h3>Total de Reclama√ß√µes BACEN</h3>
                    <span class="stat-number" id="bacen-total-dash">0</span>
                </div>
                <div class="stat-card bacen-card">
                    <h3>Em Tratativa</h3>
                    <span class="stat-number" id="bacen-tratativa-dash">0</span>
                </div>
                <div class="stat-card bacen-card">
                    <h3>Conclu√≠das</h3>
                    <span class="stat-number" id="bacen-concluidas-dash">0</span>
                </div>
                <div class="stat-card bacen-card">
                    <h3>Prazo Vencendo</h3>
                    <span class="stat-number" id="bacen-prazo-vencendo">0</span>
                </div>
            </div>

            <!-- M√©tricas Espec√≠ficas BACEN -->
            <div class="metricas-bacen">
                <h3>üìä M√©tricas Espec√≠ficas BACEN</h3>
                <div class="metricas-grid">
                    <div class="metrica-card">
                        <h4>Taxa de Resolu√ß√£o</h4>
                        <div class="metrica-valor" id="taxa-resolucao-bacen">0%</div>
                    </div>
                    <div class="metrica-card">
                        <h4>M√©dia de Prazo</h4>
                        <div class="metrica-valor" id="media-prazo-bacen">0 dias</div>
                    </div>
                    <div class="metrica-card">
                        <h4>Com Procon</h4>
                        <div class="metrica-valor" id="com-procon-bacen">0</div>
                    </div>
                    <div class="metrica-card">
                        <h4>Liquida√ß√£o Antecipada</h4>
                        <div class="metrica-valor" id="liquidacao-bacen">0</div>
                    </div>
                </div>
            </div>

            <!-- Dashboard de Urg√™ncias -->
            <div class="dashboard-urgencias-section">
                <h3>Urgentes</h3>
                <div id="dashboard-urgencias"></div>
            </div>

            <!-- Gr√°ficos BACEN -->
            <div class="graficos-bacen">
                <div class="grafico-card">
                    <h3>Status das Reclama√ß√µes</h3>
                    <div id="grafico-status-bacen"></div>
                </div>
                <div class="grafico-card">
                    <h3>Reclama√ß√µes por M√™s</h3>
                    <div id="grafico-mensal-bacen"></div>
                </div>
            </div>
        </section>

        <!-- Minhas Reclama√ß√µes BACEN -->
        <section id="minhas-reclamacoes-bacen" class="section">
            <div class="bacen-header">
                <h2>üë§ Minhas Reclama√ß√µes BACEN</h2>
                <p>Reclama√ß√µes atribu√≠das a voc√™</p>
            </div>
            
            <div id="minhas-fichas-bacen" class="fichas-container">
                <div class="loading-message">Carregando suas reclama√ß√µes...</div>
            </div>
        </section>

        <!-- Nova Reclama√ß√£o BACEN -->
        <section id="nova-reclamacao-bacen" class="section">
            <div class="bacen-header">
                <h2>‚ûï Nova Reclama√ß√£o BACEN</h2>
                <p>Registre uma nova reclama√ß√£o do Banco Central</p>
            </div>
            
            <form id="form-bacen" class="complaint-form">
                <!-- Dados B√°sicos -->
                <div class="form-section">
                    <h3>Dados B√°sicos</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bacen-data-entrada">Data de Entrada *</label>
                            <input type="date" id="bacen-data-entrada" class="velohub-input" required>
                        </div>
                        <!-- Respons√°vel ser√° preenchido automaticamente com o usu√°rio logado -->
                        <input type="hidden" id="bacen-responsavel">
                        <div class="form-group">
                            <label for="bacen-mes">M√™s *</label>
                            <select id="bacen-mes" class="velohub-input" required>
                                <option value="">Selecione...</option>
                                <option value="01/2026">01/2026</option>
                                <option value="02/2026">02/2026</option>
                                <option value="03/2026">03/2026</option>
                                <option value="04/2026">04/2026</option>
                                <option value="05/2026">05/2026</option>
                                <option value="06/2026">06/2026</option>
                                <option value="07/2026">07/2026</option>
                                <option value="08/2026">08/2026</option>
                                <option value="09/2026">09/2026</option>
                                <option value="10/2026">10/2026</option>
                                <option value="11/2026">11/2026</option>
                                <option value="12/2026">12/2026</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bacen-nome">Nome Completo *</label>
                            <input type="text" id="bacen-nome" class="velohub-input" required>
                        </div>
                        <div class="form-group">
                            <label for="bacen-cpf">CPF (000.000.000-00) *</label>
                            <input type="text" id="bacen-cpf" class="velohub-input cpf-mask" required placeholder="000.000.000-00">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bacen-origem">Origem *</label>
                            <select id="bacen-origem" class="velohub-input" required onchange="validarPrazoBacen()">
                                <option value="">Selecione...</option>
                                <option value="Bacen Celcoin">Bacen Celcoin</option>
                                <option value="Bacen Via Capital">Bacen Via Capital</option>
                                <option value="Consumidor.Gov">Consumidor.Gov</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Origem da Reclama√ß√£o *</label>
                            <div style="display: flex; gap: 16px; margin-top: 8px;">
                                <label class="radio-label">
                                    <input type="radio" name="bacen-origem-tipo" value="Liga√ß√£o" required>
                                    <span>Liga√ß√£o</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="bacen-origem-tipo" value="Ticket" required>
                                    <span>Ticket</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label>Telefone (DDD) 00000-0000</label>
                            <div id="bacen-telefones-container">
                                <input type="text" class="velohub-input telefone-mask telefone-input" placeholder="(00) 00000-0000">
                            </div>
                            <button type="button" class="btn-adicionar-telefone" onclick="adicionarTelefone('bacen-telefones-container')" style="margin-top: 8px; padding: 6px 12px; background: var(--azul-royal); color: white; border: none; border-radius: 4px; cursor: pointer;">+ Adicionar Telefone</button>
                        </div>
                    </div>
                </div>

                <!-- Detalhes da Reclama√ß√£o -->
                <div class="form-section">
                    <h3>Detalhes da Reclama√ß√£o</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bacen-rdr">RDR</label>
                            <input type="number" id="bacen-rdr" class="velohub-input" placeholder="Digite o n√∫mero do RDR">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="bacen-anexo">Anexo (PDF, DOCX, etc.)</label>
                        <input type="file" id="bacen-anexo" class="velohub-input" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" multiple>
                        <small class="form-hint">Voc√™ pode selecionar m√∫ltiplos arquivos</small>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bacen-motivo-reduzido">Motivo Reduzido *</label>
                            <select id="bacen-motivo-reduzido" class="velohub-input" required>
                                <option value="">Selecione...</option>
                                <option value="Abatimento Juros">Abatimento Juros</option>
                                <option value="Abatimento Juros/Chave PIX">Abatimento Juros/Chave PIX</option>
                                <option value="Cancelamento Conta">Cancelamento Conta</option>
                                <option value="Chave PIX">Chave PIX</option>
                                <option value="PIX/Abatimento Juros/Encerramento de conta">PIX/Abatimento Juros/Encerramento de conta</option>
                                <option value="Chave PIX/Abatimento Juros/Prob. App">Chave PIX/Abatimento Juros/Prob. App</option>
                                <option value="Chave PIX/Acesso ao App">Chave PIX/Acesso ao App</option>
                                <option value="Chave PIX/Exclus√£o de Conta">Chave PIX/Exclus√£o de Conta</option>
                                <option value="Conta">Conta</option>
                                <option value="Contesta√ß√£o de Valores">Contesta√ß√£o de Valores</option>
                                <option value="Credito do Trabalhador">Credito do Trabalhador</option>
                                <option value="Credito Pessoal">Credito Pessoal</option>
                                <option value="Cupons Velotax">Cupons Velotax</option>
                                <option value="Devolu√ß√£o √† Celcoin">Devolu√ß√£o √† Celcoin</option>
                                <option value="Fraude">Fraude</option>
                                <option value="Liquida√ß√£o Antecipada">Liquida√ß√£o Antecipada</option>
                                <option value="Liquida√ß√£o Antecipada/Abatimento Juros">Liquida√ß√£o Antecipada/Abatimento Juros</option>
                                <option value="N√£o recebeu restitui√ß√£o">N√£o recebeu restitui√ß√£o</option>
                                <option value="N√£o recebeu restitui√ß√£o/Abatimento Juros">N√£o recebeu restitui√ß√£o/Abatimento Juros</option>
                                <option value="N√£o recebeu restitui√ß√£o/Abatimento Juros/Chave PIX">N√£o recebeu restitui√ß√£o/Abatimento Juros/Chave PIX</option>
                                <option value="N√£o recebeu restitui√ß√£o/Chave PIX">N√£o recebeu restitui√ß√£o/Chave PIX</option>
                                <option value="Probl. App/Gov">Probl. App/Gov</option>
                                <option value="Seguro Celular">Seguro Celular</option>
                                <option value="Seguro Divida Zero">Seguro Divida Zero</option>
                                <option value="Seguro Prestamista">Seguro Prestamista</option>
                                <option value="Seguro Saude">Seguro Saude</option>
                                <option value="Superendividamento">Superendividamento</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="bacen-prazo-bacen">Prazo Bacen <span id="prazo-bacen-obrigatorio" style="display:none;">*</span></label>
                            <input type="date" id="bacen-prazo-bacen" class="velohub-input">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="bacen-motivo-detalhado">Motivo Reclama√ß√£o *</label>
                        <textarea id="bacen-motivo-detalhado" class="velohub-input" rows="4" placeholder="Descreva detalhadamente a reclama√ß√£o..." required></textarea>
                    </div>
                </div>

                <!-- Tentativas de Contato -->
                <div class="form-section">
                    <h3>Tentativas de Contato</h3>
                    <div id="tentativas-contato-bacen">
                        <div class="form-row tentativa-item">
                            <div class="form-group">
                                <label>1¬™ tentativa</label>
                                <input type="date" class="velohub-input tentativa-data" data-tentativa="1">
                            </div>
                            <div class="form-group">
                                <label>2¬™ tentativa</label>
                                <input type="date" class="velohub-input tentativa-data" data-tentativa="2">
                            </div>
                        </div>
                    </div>
                    <button type="button" class="velohub-btn btn-secondary" onclick="adicionarTentativaBacen()">‚ûï Adicionar Tentativa</button>
                </div>

                <!-- Acionamentos ao Canais de Atendimento e Protocolos -->
                <div class="form-section">
                    <h3>Acionamentos ao Canais de Atendimento e Protocolos</h3>
                    <div class="form-row">
                        <div class="form-group" style="flex: 0 0 200px;">
                            <label class="checkbox-label">
                                <input type="checkbox" id="bacen-acionou-central" onchange="toggleProtocolo('bacen-acionou-central', 'bacen-protocolo-central')">
                                <span class="checkmark"></span>
                                Acionou a central?
                            </label>
                        </div>
                        <div class="form-group" id="bacen-protocolo-central-group" style="display: none; flex: 1;">
                            <label for="bacen-protocolo-central">Qual Protocolo</label>
                            <div id="bacen-protocolos-central-container">
                                <input type="text" class="velohub-input protocolo-input" placeholder="Digite o protocolo">
                            </div>
                            <button type="button" class="btn-adicionar-protocolo" onclick="adicionarProtocolo('bacen-protocolos-central-container')" style="margin-top: 8px; padding: 6px 12px; background: var(--azul-royal); color: white; border: none; border-radius: 4px; cursor: pointer;">+ Adicionar Protocolo</button>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group" style="flex: 0 0 200px;">
                            <label class="checkbox-label">
                                <input type="checkbox" id="bacen-n2-segundo-nivel" onchange="toggleProtocolo('bacen-n2-segundo-nivel', 'bacen-protocolo-n2')">
                                <span class="checkmark"></span>
                                N2 ‚Äì Segundo N√≠vel?
                            </label>
                        </div>
                        <div class="form-group" id="bacen-protocolo-n2-group" style="display: none; flex: 1;">
                            <label for="bacen-protocolo-n2">Qual Protocolo</label>
                            <div id="bacen-protocolos-n2-container">
                                <input type="text" class="velohub-input protocolo-input" placeholder="Digite o protocolo">
                            </div>
                            <button type="button" class="btn-adicionar-protocolo" onclick="adicionarProtocolo('bacen-protocolos-n2-container')" style="margin-top: 8px; padding: 6px 12px; background: var(--azul-royal); color: white; border: none; border-radius: 4px; cursor: pointer;">+ Adicionar Protocolo</button>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group" style="flex: 0 0 200px;">
                            <label class="checkbox-label">
                                <input type="checkbox" id="bacen-reclame-aqui" onchange="toggleProtocolo('bacen-reclame-aqui', 'bacen-protocolo-reclame-aqui')">
                                <span class="checkmark"></span>
                                Reclame Aqui?
                            </label>
                        </div>
                        <div class="form-group" id="bacen-protocolo-reclame-aqui-group" style="display: none; flex: 1;">
                            <label for="bacen-protocolo-reclame-aqui">Qual Protocolo</label>
                            <div id="bacen-protocolos-reclame-aqui-container">
                                <input type="text" class="velohub-input protocolo-input" placeholder="Digite o protocolo">
                            </div>
                            <button type="button" class="btn-adicionar-protocolo" onclick="adicionarProtocolo('bacen-protocolos-reclame-aqui-container')" style="margin-top: 8px; padding: 6px 12px; background: var(--azul-royal); color: white; border: none; border-radius: 4px; cursor: pointer;">+ Adicionar Protocolo</button>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group" style="flex: 0 0 200px;">
                            <label class="checkbox-label">
                                <input type="checkbox" id="bacen-procon" onchange="toggleProtocolo('bacen-procon', 'bacen-protocolo-procon')">
                                <span class="checkmark"></span>
                                Procon?
                            </label>
                        </div>
                        <div class="form-group" id="bacen-protocolo-procon-group" style="display: none; flex: 1;">
                            <label for="bacen-protocolo-procon">Qual Protocolo</label>
                            <div id="bacen-protocolos-procon-container">
                                <input type="text" class="velohub-input protocolo-input" placeholder="Digite o protocolo">
                            </div>
                            <button type="button" class="btn-adicionar-protocolo" onclick="adicionarProtocolo('bacen-protocolos-procon-container')" style="margin-top: 8px; padding: 6px 12px; background: var(--azul-royal); color: white; border: none; border-radius: 4px; cursor: pointer;">+ Adicionar Protocolo</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="bacen-protocolos-sem-acionamento">Protocolos em que n√£o houve acionamento em nenhum dos canais de Atendimento</label>
                        <input type="text" id="bacen-protocolos-sem-acionamento" class="velohub-input" placeholder="Digite os protocolos (relacionados √† reclama√ß√£o)">
                    </div>
                </div>

                <!-- Libera√ß√£o do PIX -->
                <div class="form-section">
                    <h3>Libera√ß√£o do PIX</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bacen-pix-status">PIX liberado ou exclu√≠do?</label>
                            <select id="bacen-pix-status" class="velohub-input" onchange="verificarAutoCobrancaBacen()">
                                <option value="">Selecione...</option>
                                <option value="Liberado">Liberado</option>
                                <option value="Exclu√≠do">Exclu√≠do</option>
                                <option value="Solicitada">Solicitada</option>
                                <option value="N√£o aplic√°vel">N√£o aplic√°vel</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Status do contrato</label>
                            <div style="display: flex; gap: 16px; margin-top: 8px;">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="bacen-status-contrato-quitado" onchange="verificarAutoCobrancaBacen()">
                                    <span class="checkmark"></span>
                                    Quitado
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="bacen-status-contrato-aberto" onchange="verificarAutoCobrancaBacen()">
                                    <span class="checkmark"></span>
                                    Em aberto
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Observa√ß√µes -->
                <div class="form-section">
                    <h3>Observa√ß√µes</h3>
                    <div class="form-group">
                        <label for="bacen-observacoes">Observa√ß√µes</label>
                        <textarea id="bacen-observacoes" class="velohub-input" rows="4" placeholder="Digite as observa√ß√µes..."></textarea>
                    </div>
                </div>

                <!-- Casos Cr√≠ticos (Blacklist) -->
                <div class="form-section">
                    <h3>Casos Cr√≠ticos (Blacklist)</h3>
                    <div class="form-row">
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="bacen-casos-criticos">
                            <span class="checkmark"></span>
                            Blacklist
                        </label>
                        </div>
                        <div class="form-group">
                            <label>Enviar para cobran√ßa? *</label>
                            <div style="display: flex; gap: 16px; margin-top: 8px;">
                                <label class="radio-label">
                                    <input type="radio" name="bacen-enviar-cobranca" value="Sim" required>
                                    <span>Sim</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="bacen-enviar-cobranca" value="N√£o" required>
                                    <span>N√£o</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resolu√ß√£o -->
                <div class="form-section">
                    <h3>‚úÖ Resolu√ß√£o</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bacen-status">Status *</label>
                            <select id="bacen-status" class="velohub-input" required>
                                <option value="">Selecione...</option>
                                <option value="nao-iniciado">N√£o Iniciado</option>
                                <option value="em-tratativa">Em Tratativa</option>
                                <option value="concluido">Conclu√≠do</option>
                                <option value="respondido">Respondido</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="bacen-finalizado-em">Finalizado em</label>
                            <input type="date" id="bacen-finalizado-em" class="velohub-input">
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="velohub-btn">üíæ Salvar Reclama√ß√£o BACEN</button>
                    <button type="button" class="velohub-btn btn-secondary" onclick="limparFormBacen()">üóëÔ∏è Limpar</button>
                </div>
            </form>
        </section>

        <!-- Lista de Reclama√ß√µes BACEN -->
        <section id="lista-bacen" class="section">
            <div class="bacen-header">
                <h2>üìã Lista de Reclama√ß√µes BACEN</h2>
                <p>Todas as reclama√ß√µes registradas no Banco Central</p>
            </div>
            
            <div class="list-controls">
                <div class="search-box">
                    <input type="text" id="busca-bacen" class="velohub-input" placeholder="üîç Buscar por nome, CPF ou motivo...">
                </div>
                <div class="filter-controls">
                    <select id="filtro-status-bacen" class="velohub-input">
                        <option value="">Todos os Status</option>
                        <option value="nao-iniciado">N√£o Iniciado</option>
                        <option value="em-tratativa">Em Tratativa</option>
                        <option value="concluido">Conclu√≠do</option>
                        <option value="respondido">Respondido</option>
                    </select>
                </div>
            </div>
            
            <div id="lista-fichas-bacen" class="complaints-list">
                <!-- Lista ser√° populada dinamicamente -->
            </div>
        </section>

        <!-- Relat√≥rios BACEN -->
        <section id="relatorios-bacen" class="section">
            <div class="bacen-header">
                <h2>üìà Relat√≥rios BACEN</h2>
                <p>Relat√≥rios espec√≠ficos para demandas do Banco Central</p>
            </div>
            
            <div class="reports-grid">
                <div class="report-card">
                    <h3>üìä Relat√≥rio por Per√≠odo</h3>
                    <p>An√°lise temporal das reclama√ß√µes BACEN</p>
                    <button class="velohub-btn" onclick="gerarRelatorioPeriodoBacen()">Gerar Relat√≥rio</button>
                </div>
                <div class="report-card">
                    <h3>‚è∞ Relat√≥rio de Prazos</h3>
                    <p>Fichas com prazo vencendo ou vencido</p>
                    <button class="velohub-btn" onclick="gerarRelatorioPrazosBacen()">Gerar Relat√≥rio</button>
                </div>
                <div class="report-card">
                    <h3>üìã Relat√≥rio Completo</h3>
                    <p>Todas as fichas BACEN</p>
                    <button class="velohub-btn" onclick="gerarRelatorioCompletoBacen()">Gerar Relat√≥rio</button>
                </div>
            </div>
            
            <div id="conteudo-relatorio-bacen" class="report-content" style="display: none;">
                <!-- Conte√∫do do relat√≥rio ser√° exibido aqui -->
            </div>
        </section>
    </main>

    <!-- JavaScript -->
    <!-- Configura√ß√£o Google SSO -->
    <script>
        window.GOOGLE_CLIENT_ID = '638842930106-b0plff0sbbs0ljsm39n5kadsjfcj3u3q.apps.googleusercontent.com';
    </script>
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="js/config-firebase.js"></script>
    <!-- Firebase Manager Corrigido - Aguarda inicializa√ß√£o completa -->
    <script src="js/firebase-init-v2.js"></script>
    <script src="js/firebase-db.js"></script>
    <script src="js/armazenamento-reclamacoes.js"></script>
    <!-- Outros scripts -->
    <script src="js/loading.js"></script>
    <script src="js/validador-velotax.js"></script>
    <script src="js/google-sso.js"></script>
    <script src="js/auth-system.js"></script>
    <script src="js/gerenciador-fichas-perfil.js"></script>
    <script src="js/gerenciador-anexos.js"></script>
    <script src="js/fichas-especificas.js"></script>
    <script src="js/sistema-alertas.js"></script>
    <script src="js/busca-avancada.js"></script>
    <script src="js/historico-cliente.js"></script>
    <script src="js/atalhos-teclado.js"></script>
    <script src="js/exportacao-relatorios.js"></script>
    <script src="js/exportacao-excel.js"></script>
    <script src="js/validacao-condicional.js"></script>
    <script src="js/theme-toggle.js"></script>
    <script src="js/graficos-detalhados.js"></script>
    <script src="js/controle-graficos-dashboard.js"></script>
    <script src="js/lista-casos-abertos.js"></script>
    <script src="js/filtros-exportacao-csv.js"></script>
    <script src="js/bacen-page.js"></script>
    <script>
        // Fun√ß√£o para mostrar/ocultar campos de protocolo
        function toggleProtocolo(checkboxId, protocoloInputId) {
            const checkbox = document.getElementById(checkboxId);
            const protocoloGroup = document.getElementById(protocoloInputId + '-group');
            const protocoloInput = document.getElementById(protocoloInputId);
            
            if (checkbox && protocoloGroup) {
                if (checkbox.checked) {
                    protocoloGroup.style.display = 'flex';
                    protocoloInput.required = true;
                } else {
                    protocoloGroup.style.display = 'none';
                    protocoloInput.required = false;
                    protocoloInput.value = '';
                }
            }
        }
        
        // Fun√ß√£o para adicionar m√∫ltiplos protocolos (global)
        window.adicionarProtocolo = function(containerId) {
            const container = document.getElementById(containerId);
            if (!container) {
                console.error('Container n√£o encontrado:', containerId);
                return;
            }
            
            const protocoloDiv = document.createElement('div');
            protocoloDiv.className = 'protocolo-item-multiplo';
            protocoloDiv.style.display = 'flex';
            protocoloDiv.style.gap = '8px';
            protocoloDiv.style.marginTop = '8px';
            protocoloDiv.innerHTML = `
                <input type="text" class="velohub-input protocolo-input" placeholder="Digite o protocolo" style="flex: 1;">
                <button type="button" onclick="this.parentElement.remove()" style="padding: 8px 12px; background: #ff4757; color: white; border: none; border-radius: 4px; cursor: pointer;">‚úï</button>
            `;
            container.appendChild(protocoloDiv);
        };
        
        // Fun√ß√£o para coletar todos os protocolos de um container (global)
        window.obterProtocolosDoContainer = function(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return [];
            
            const inputs = container.querySelectorAll('.protocolo-input');
            const protocolos = Array.from(inputs)
                .map(input => input.value.trim())
                .filter(valor => valor.length > 0);
            
            return protocolos;
        };
        
        // Fun√ß√£o para adicionar m√∫ltiplos telefones (global)
        window.adicionarTelefone = function(containerId) {
            const container = document.getElementById(containerId);
            if (!container) {
                console.error('Container n√£o encontrado:', containerId);
                return;
            }
            
            const telefoneDiv = document.createElement('div');
            telefoneDiv.className = 'telefone-item-multiplo';
            telefoneDiv.style.display = 'flex';
            telefoneDiv.style.gap = '8px';
            telefoneDiv.style.marginTop = '8px';
            telefoneDiv.innerHTML = `
                <input type="text" class="velohub-input telefone-mask telefone-input" placeholder="(00) 00000-0000" style="flex: 1;">
                <button type="button" onclick="this.parentElement.remove()" style="padding: 8px 12px; background: #ff4757; color: white; border: none; border-radius: 4px; cursor: pointer;">‚úï</button>
            `;
            container.appendChild(telefoneDiv);
            
            // Aplicar m√°scara no novo campo
            if (window.aplicarMascaraTelefone) {
                const novoInput = telefoneDiv.querySelector('.telefone-mask');
                if (novoInput) {
                    window.aplicarMascaraTelefone(novoInput);
                }
            }
        };
        
        // Fun√ß√£o para coletar todos os telefones de um container (global)
        window.obterTelefonesDoContainer = function(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return [];
            
            const inputs = container.querySelectorAll('.telefone-input');
            const telefones = Array.from(inputs)
                .map(input => input.value.trim())
                .filter(valor => valor.length > 0);
            
            return telefones;
        };

        // Fun√ß√£o para adicionar tentativas de contato
        let contadorTentativasBacen = 2;
        function adicionarTentativaBacen() {
            contadorTentativasBacen++;
            const container = document.getElementById('tentativas-contato-bacen');
            const novaTentativa = document.createElement('div');
            novaTentativa.className = 'form-row tentativa-item';
            novaTentativa.innerHTML = `
                <div class="form-group">
                    <label>${contadorTentativasBacen}¬™ tentativa (dia/m√™s/ano)</label>
                    <input type="date" class="velohub-input tentativa-data" data-tentativa="${contadorTentativasBacen}">
                </div>
                <div class="form-group">
                    <button type="button" class="velohub-btn btn-secondary" onclick="removerTentativaBacen(this)" style="margin-top: 24px;">üóëÔ∏è Remover</button>
                </div>
            `;
            container.appendChild(novaTentativa);
        }

        function removerTentativaBacen(btn) {
            btn.closest('.tentativa-item').remove();
        }
    </script>
    <!-- Script de Depura√ß√£o Firebase - Carregamento e Diagn√≥stico -->
    <script src="js/DEBUG_CARREGAMENTO_FIREBASE.js"></script>
    <script src="js/formulario-dinamico.js"></script>
    <script src="js/sistema-notificacoes.js"></script>
</body>
</html>

